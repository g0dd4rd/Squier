<!doctype html>
<html>
<head>
 <meta charset="UTF-8">
 <title>Squier</title>
</head>
<body>
<h1>Squier</h1>
<p>Use w, e, t, y, u and a, s, d, f, g, h, j, k, l and space bar. Your ears will guide you.</p>
<canvas id='canvas' width='600' height='400'></canvas>
<script src='squier.js'></script>
<script language="JavaScript">
var can = document.getElementById('canvas');
var c = can.getContext('2d');

function mainLoop() {
  //var c = can.getContext('2d');
  updateGame();
  updateBackground();
  updateNotes();
  updatePlayer();

  checkCollisions();

  drawBackground(c);
  drawNotes(c);
  drawPlayer(c);
  drawOverlay(c);
}


// =========== player ============
function drawPlayer(c) {
  if(player.state == 'dead') return;
    
  if(player.state == 'hit') {
    c.fillStyle = 'white';
    c.fillRect(player.x, player.y, player.width, player.height);
    return;
  }

  c.fillStyle = player.color;
  c.fillRect(player.x, player.y, player.width, player.height);
}

// =========== background ============
function drawBackground(c) {
  c.fillStyle = background.color;
  c.fillRect(0, 0, can.width, can.height);
}

// =========== enemies ===============
function drawNotes(c) {
  var note;
  c.font = '10pt Arial';
  for(var i in semitones) {
    note = semitones[i];
    c.fillRect(note.x, note.y, note.width, note.height);
  }
}

// =========== overlay ===============
function drawOverlay(c) {

  // draw score
  c.fillStyle = 'white';
  c.font = '14pt Arial';
  c.fillText(player.counter, 10, 20);

  if(game.state == 'start') {
    c.fillText('press space to play', 190, 250);
    c.font = "Bold 40pt Arial";
    c.fillText('READY YOUR EARS', 30, 200);
  }

  if(game.state == 'over') {
    c.fillText(overlay.subtitle, 190, 250);
    c.font = "Bold 40pt Arial";
    c.fillText(overlay.title, 30, 200);
  }
  
  if(game.state == 'won') {
    c.fillText(overlay.subtitle, 190, 250);
    c.font = 'Bold 40pt Arial';
    c.fillText(overlay.title, 50, 200);
  }
}

checkEvents();
setInterval(mainLoop, 1000 / 30);
</script>
</body>
</html>

